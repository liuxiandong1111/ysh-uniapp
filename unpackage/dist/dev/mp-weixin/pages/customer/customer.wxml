<view class="container"><view class="search-bar"><view class="search-bar-wrap"><view class="search-input-wrap"><view class="search-icon"><text class="iconfont">🔍</text></view><input class="search-input" type="text" placeholder="搜索客户姓名或手机号" data-event-opts="{{[['confirm',[['handleSearch',['$event']]]],['input',[['__set_model',['','searchKey','$event',[]]]]]]}}" value="{{searchKey}}" bindconfirm="__e" bindinput="__e"/></view><view data-event-opts="{{[['tap',[['handleSearch',['$event']]]]]}}" class="search-btn" bindtap="__e">搜索</view><view data-event-opts="{{[['tap',[['toggleFilterForm',['$event']]]]]}}" class="filter-btn" bindtap="__e"><text>筛选</text><text class="filter-icon">{{showFilterForm?'▲':'▼'}}</text></view></view><block wx:if="{{showFilterForm}}"><view class="filter-form"><view class="form-row"><view class="form-group"><text class="form-label">手机号</text><input class="form-select" style="height:30px;font-size:14px;" type="text" placeholder="请输入手机号" data-event-opts="{{[['input',[['__set_model',['','phone','$event',[]]]]]]}}" value="{{phone}}" bindinput="__e"/></view><view class="form-group"><text class="form-label">所属部门</text><picker class="form-select" range="{{departmentOptions}}" data-event-opts="{{[['change',[['departmentChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{departmentOptions[currentDepartment]}}</view></picker></view></view><view class="form-row"><view class="form-group"><text class="form-label">客户状态</text><picker class="form-select" range="{{statusOptions}}" data-event-opts="{{[['change',[['statusChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{statusOptions[currentStatus]}}</view></picker></view><view class="form-group"><text class="form-label">审批状态</text><picker class="form-select" range="{{approvalOptions}}" data-event-opts="{{[['change',[['approvalChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{approvalOptions[currentApproval]}}</view></picker></view></view></view></block></view><view class="{{['main',(showFilterForm)?'filter-shown':'',(!showFilterForm)?'filter-hidden':'']}}"><view class="customer-list"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="customer-item"><view class="item-main"><view class="customer-info"><view class="name-status"><text class="name">{{item.$orig.name||'未知'}}</text><text class="{{['status','statusClass-'+(item.$orig.status||1)]}}">{{dictMaps.customerStatus[item.$orig.status]||'未知状态'}}</text></view><view class="phone"><text class="label">手机号:</text><text>{{item.$orig.phone||'未填写'}}</text></view><view class="dept"><text class="label">所属部门:</text><text>{{item.$orig.branch_name||'未分配'}}</text></view><view class="dept"><text class="label">客户类型:</text><text>{{dictMaps.customerType[item.$orig.client_type]||'未知类型'}}</text></view><view class="manager"><text class="label">业务员:</text><text>{{item.$orig.service_name||'未分配'}}</text></view><block wx:if="{{item.$orig.product_name}}"><view class="manager"><text class="label">产品员:</text><text>{{item.$orig.product_name}}</text></view></block><view class="create-time"><text class="label">创建时间:</text><text>{{item.m0}}</text></view></view><view class="approval-status"><text class="{{['status-box','dealClass-'+(item.$orig.deal_status||1)]}}">{{''+(dictMaps.dealStatus[item.$orig.deal_status]||'未知状态')+''}}</text><block wx:if="{{item.$orig.age}}"><text class="client-age">{{item.$orig.age+"岁"}}</text></block><block wx:if="{{item.$orig.matrimony}}"><text class="marital-status">{{dictMaps.maritalStatus[item.$orig.matrimony]}}</text></block></view></view><view class="item-actions"><view data-event-opts="{{[['tap',[['goDetail',['$0'],[[['customerList','',index]]]]]]]}}" class="action-btn" bindtap="__e"><text class="iconfont icon-detail"></text><text>详情</text></view><view data-event-opts="{{[['tap',[['goEdit',['$0'],[[['customerList','',index]]]]]]]}}" class="action-btn" bindtap="__e"><text class="iconfont icon-edit"></text><text>编辑</text></view><view data-event-opts="{{[['tap',[['goFollowup',['$0'],[[['customerList','',index]]]]]]]}}" class="action-btn" bindtap="__e"><text class="iconfont icon-comment"></text><text>跟进记录</text></view><view data-event-opts="{{[['tap',[['updateStatus',['$0'],[[['customerList','',index]]]]]]]}}" class="action-btn" bindtap="__e"><text class="iconfont icon-status"></text><text>更新状态</text></view><view data-event-opts="{{[['tap',[['transferCustomer',['$0'],[[['customerList','',index]]]]]]]}}" class="action-btn" bindtap="__e"><text class="iconfont icon-status"></text><text>移交产品部</text></view></view></view></block><block wx:if="{{$root.g0===0}}"><view class="empty-tip">暂无客户数据</view></block><block wx:if="{{totalCount>0}}"><view class="pagination"><view class="pagination-info">{{'共 '+totalCount+" 条数据，当前页 "+page+"/"+$root.g1+''}}</view><view class="pagination-btn-group"><view data-event-opts="{{[['tap',[['prevPage',['$event']]]]]}}" class="{{['pagination-btn',(page<=1)?'disabled':'']}}" bindtap="__e">上一页</view><view data-event-opts="{{[['tap',[['nextPage',['$event']]]]]}}" class="{{['pagination-btn',(page>=$root.g2)?'disabled':'']}}" bindtap="__e">下一页</view></view></view></block></view><view data-event-opts="{{[['tap',[['goAdd',['$event']]]]]}}" class="add-fab" bindtap="__e"><text class="iconfont icon-add"></text></view></view></view>