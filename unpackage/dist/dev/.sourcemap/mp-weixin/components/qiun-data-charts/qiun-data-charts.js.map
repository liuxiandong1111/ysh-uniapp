{"version":3,"sources":[null,"webpack:///E:/ysh/ysh-uniapp/components/qiun-data-charts/qiun-data-charts.vue?8c26","webpack:///E:/ysh/ysh-uniapp/components/qiun-data-charts/qiun-data-charts.vue?04d1","webpack:///E:/ysh/ysh-uniapp/components/qiun-data-charts/qiun-data-charts.vue?bec9","uni-app:///components/qiun-data-charts/qiun-data-charts.vue","webpack:///E:/ysh/ysh-uniapp/components/qiun-data-charts/qiun-data-charts.vue?9191","webpack:///E:/ysh/ysh-uniapp/components/qiun-data-charts/qiun-data-charts.vue?8b5b"],"names":["name","props","type","default","canvasId","chartData","background","width","height","pixelRatio","animation","config","data","cWidth","cHeight","inited","errorShow","errorMessage","uChartsInstance","created","mounted","setTimeout","watch","handler","deep","methods","drawCharts","query","node","size","console","canvas","fallbackDrawCanvas","initChart","context","series","categories","chartConfig","touchStart","touchMove","touchEnd","resizeChart"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACoE;AACL;AACa;;;AAG5E;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,sFAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA0mB,CAAgB,ooBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACoB9nB;AACA;AAAA;AAAA;AAAA,gBAEA;EACAA;EACAC;IACAC;MACAA;MACAC;IACA;IACAC;MACAF;MACAC;QACA;MACA;IACA;IACAE;MACAH;MACAC;IACA;IACAG;MACAJ;MACAC;IACA;IACAI;MACAL;MACAC;IACA;IACAK;MACAN;MACAC;IACA;IACAM;MACAP;MACAC;IACA;IACAO;MACAR;MACAC;IACA;IACAQ;MACAT;MACAC;IACA;EACA;EACAS;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;IACA;MACA;IACA;MACA;IACA;IACA;MACA;IACA;MACA;IACA;EACA;EACAC;IAAA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAjB;MACAkB;QAAA;QACA;UACA;UACAF;YACA;UACA;QACA;UACA;UACA;QACA;MACA;MACAG;IACA;EACA;EACAC;IACAC;MAAA;MACA;;MAEA;QACA;QACAC;UAAAC;UAAAC;QAAA;UACA;YACAC;YACA;YACA;YACA;UACA;UAEA;UACA;UAEA;YACAA;YACA;YACA;UACA;UAEA;YACAC;YACAxB;YACAC;UACA;QACA;MACA;QACAsB;QACA;MACA;IAUA;IAEA;IACAE;MACAF;MACA;QACA;QACA;UACA;UACA;UACA;QACA;QAEA;UACAvB;UACAC;QACA;MACA;QACAsB;QACA;QACA;QACA;MACA;IACA;IAEA;IACAG;MACA;QACA;;QAEA;QACA;UACA/B;UACAgC;UACA3B;UACAC;UACA2B;UACAC;UACA1B;UACAJ;UACAG;QAAA,GACA4B,cACA1B,QACA;QAEA;MACA;QACAmB;QACA;QACA;QACA;MACA;IACA;IAEAQ;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;UACAlC;UACAC;QACA;MACA;IACA;EACA;AACA;AAAA,4B;;;;;;;;;;;;;ACxOA;AAAA;AAAA;AAAA;AAA43B,CAAgB,63BAAG,EAAC,C;;;;;;;;;;;ACAh5B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/qiun-data-charts/qiun-data-charts.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./qiun-data-charts.vue?vue&type=template&id=f10dbef8&\"\nvar renderjs\nimport script from \"./qiun-data-charts.vue?vue&type=script&lang=js&\"\nexport * from \"./qiun-data-charts.vue?vue&type=script&lang=js&\"\nimport style0 from \"./qiun-data-charts.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/qiun-data-charts/qiun-data-charts.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qiun-data-charts.vue?vue&type=template&id=f10dbef8&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qiun-data-charts.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qiun-data-charts.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"chartsdom\" :style=\"{ width: cWidth + 'px', height: cHeight + 'px', background: background }\">\r\n\t\t<canvas \r\n\t\t\t:canvas-id=\"canvasId\" \r\n\t\t\t:id=\"canvasId\" \r\n\t\t\ttype=\"2d\"\r\n\t\t\t:style=\"{ width: cWidth + 'px', height: cHeight + 'px', background: background }\"\r\n\t\t\t@touchstart=\"touchStart\"\r\n\t\t\t@touchmove=\"touchMove\"\r\n\t\t\t@touchend=\"touchEnd\"\r\n\t\t></canvas>\r\n\t\t<view v-if=\"errorShow\" class=\"charts-error\">\r\n\t\t\t<view class=\"charts-error-img\"></view>\r\n\t\t\t<view class=\"charts-error-text\">{{errorMessage}}</view>\r\n\t\t</view>\r\n\t\t<slot v-if=\"errorShow\"></slot>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport uCharts from './uCharts.js';\r\nimport config from './config.js';\r\n\r\nexport default {\r\n\tname: 'qiun-data-charts',\r\n\tprops: {\r\n\t\ttype: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tcanvasId: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault() {\r\n\t\t\t\treturn `qiun_chart_${Math.random().toString(36).slice(2)}`;\r\n\t\t\t}\r\n\t\t},\r\n\t\tchartData: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tbackground: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'transparent'\r\n\t\t},\r\n\t\twidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\theight: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tpixelRatio: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 2\r\n\t\t},\r\n\t\tanimation: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tconfig: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcWidth: 375,\r\n\t\t\tcHeight: 250,\r\n\t\t\tinited: true,\r\n\t\t\terrorShow: false,\r\n\t\t\terrorMessage: null,\r\n\t\t\tuChartsInstance: null\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\t// 获取设备宽高，设置默认宽高\r\n\t\tconst system = uni.getSystemInfoSync();\r\n\t\tif (this.width === null) {\r\n\t\t\tthis.cWidth = system.windowWidth;\r\n\t\t} else {\r\n\t\t\tthis.cWidth = this.width;\r\n\t\t}\r\n\t\tif (this.height === null) {\r\n\t\t\tthis.cHeight = system.windowWidth * 0.6;\r\n\t\t} else {\r\n\t\t\tthis.cHeight = this.height;\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\t// 延迟一下再初始化图表，确保canvas节点已渲染\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.drawCharts();\r\n\t\t}, 100);\r\n\t},\r\n\twatch: {\r\n\t\tchartData: {\r\n\t\t\thandler(val, oldval) {\r\n\t\t\t\tif (val.series && val.series.length > 0) {\r\n\t\t\t\t\t// 延迟一下确保组件更新完成\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.drawCharts();\r\n\t\t\t\t\t}, 50);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.errorShow = true;\r\n\t\t\t\t\tthis.errorMessage = '请添加数据源';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tdrawCharts() {\r\n\t\t\t// 微信小程序和其他小程序处理方式可能不同\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\ttry {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tquery.select(`#${this.canvasId}`).fields({node: true, size: true}).exec(res => {\r\n\t\t\t\t\tif (!res[0] || !res[0].node) {\r\n\t\t\t\t\t\tconsole.error('无法获取节点', res);\r\n\t\t\t\t\t\t// 尝试直接使用 createCanvasContext\r\n\t\t\t\t\t\tthis.fallbackDrawCanvas();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst canvas = res[0].node;\r\n\t\t\t\t\tconst ctx = canvas.getContext('2d');\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!ctx) {\r\n\t\t\t\t\t\tconsole.error('无法获取2d上下文');\r\n\t\t\t\t\t\tthis.fallbackDrawCanvas();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.initChart(ctx, {\r\n\t\t\t\t\t\tcanvas,\r\n\t\t\t\t\t\twidth: this.cWidth,\r\n\t\t\t\t\t\theight: this.cHeight\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('canvas查询失败', e);\r\n\t\t\t\tthis.fallbackDrawCanvas();\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\t// #ifdef MP-ALIPAY || MP-BAIDU || MP-TOUTIAO || MP-QQ || MP-360\r\n\t\t\tthis.fallbackDrawCanvas();\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\t// #ifndef MP\r\n\t\t\tthis.fallbackDrawCanvas();\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\t\r\n\t\t// 回退方案，使用传统的方式\r\n\t\tfallbackDrawCanvas() {\r\n\t\t\tconsole.log('使用传统方式获取canvas上下文');\r\n\t\t\ttry {\r\n\t\t\t\tconst ctx = uni.createCanvasContext(this.canvasId, this);\r\n\t\t\t\tif (!ctx) {\r\n\t\t\t\t\tthis.errorShow = true;\r\n\t\t\t\t\tthis.errorMessage = '无法获取canvas上下文';\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.initChart(ctx, {\r\n\t\t\t\t\twidth: this.cWidth,\r\n\t\t\t\t\theight: this.cHeight\r\n\t\t\t\t});\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('创建canvas上下文失败', e);\r\n\t\t\t\tthis.errorShow = true;\r\n\t\t\t\tthis.errorMessage = '图表初始化失败';\r\n\t\t\t\tthis.$emit('error', e);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 初始化图表\r\n\t\tinitChart(ctx, config) {\r\n\t\t\ttry {\r\n\t\t\t\tconst chartConfig = this.config || (config[this.type] || {});\r\n\t\t\t\t\r\n\t\t\t\t// 初始化图表\r\n\t\t\t\tthis.uChartsInstance = new uCharts({\r\n\t\t\t\t\ttype: this.type,\r\n\t\t\t\t\tcontext: ctx,\r\n\t\t\t\t\twidth: this.cWidth,\r\n\t\t\t\t\theight: this.cHeight,\r\n\t\t\t\t\tseries: this.chartData.series,\r\n\t\t\t\t\tcategories: this.chartData.categories || [],\r\n\t\t\t\t\tanimation: this.animation,\r\n\t\t\t\t\tbackground: this.background,\r\n\t\t\t\t\tpixelRatio: this.pixelRatio,\r\n\t\t\t\t\t...chartConfig,\r\n\t\t\t\t\t...config\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tthis.$emit('inited', this.uChartsInstance);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('图表初始化失败', e);\r\n\t\t\t\tthis.errorShow = true;\r\n\t\t\t\tthis.errorMessage = '图表初始化失败';\r\n\t\t\t\tthis.$emit('error', e);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\ttouchStart(e) {\r\n\t\t\tif(this.uChartsInstance) {\r\n\t\t\t\tthis.uChartsInstance.touchStart(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttouchMove(e) {\r\n\t\t\tif(this.uChartsInstance) {\r\n\t\t\t\tthis.uChartsInstance.touchMove(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttouchEnd(e) {\r\n\t\t\tif(this.uChartsInstance) {\r\n\t\t\t\tthis.uChartsInstance.touchEnd(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tresizeChart() {\r\n\t\t\tif (this.uChartsInstance) {\r\n\t\t\t\t// 调整宽高后更新图表\r\n\t\t\t\tthis.uChartsInstance.updateData({\r\n\t\t\t\t\twidth: this.cWidth,\r\n\t\t\t\t\theight: this.cHeight\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\n.chartsdom {\r\n\tposition: relative;\r\n}\r\n\r\n.charts-error {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground-color: rgba(255, 255, 255, 0.8);\r\n\tz-index: 998;\r\n}\r\n\r\n.charts-error-img {\r\n\twidth: 80px;\r\n\theight: 80px;\r\n}\r\n\r\n.charts-error-text {\r\n\tmargin-top: 10px;\r\n\tfont-size: 12px;\r\n\tcolor: #909399;\r\n}\r\n</style> ","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qiun-data-charts.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qiun-data-charts.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1747548606650\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}