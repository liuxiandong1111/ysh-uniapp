{"version":3,"sources":["uni-app:///main.js","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?6d3d","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?d91f","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?ebd4","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?1216","uni-app:///pages/followup/followup.vue","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?ac9a","webpack:////Users/liuxiandong/Desktop/ysh/ysh-uniapp/pages/followup/followup.vue?be76"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","customerId","customerInfo","name","phone","status","followupList","formData","content","loading","onLoad","console","methods","loadFollowupList","customerApi","uni","title","icon","getStatusText","onDateChange","submitFollowup","id","info","goBack"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,iBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACa;;;AAGpE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAAA;AAAs0B,CAAgB,syBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACiD11B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IACA;MACAC;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;QACAC;MACA;MACAC;IACA;EACA;EACAC;IACA;MACA;;MAEA;MACA;QACA;UACA;UACA;UACAC;QACA;UACAA;QACA;MACA;;MAEA;MACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;MACA;MAEA;;MAEA;MACAC;QACA;QACA;UACA;UACA;UAEA;YACAH;UACA;QACA;UACAI;YACAC;YACAC;UACA;QACA;MACA;QACA;QACAF;UACAC;UACAC;QACA;QACAN;MACA;IACA;IAEA;IACAO;MACA;QACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACAL;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACA;MACA;;MAEA;MACAH;QACAO;QACAC;MACA;QACA;QACA;UACAP;YACAC;YACAC;UACA;;UAEA;UACA;;UAEA;UACA;QACA;UACAF;YACAC;YACAC;UACA;QACA;MACA;QACA;QACAF;UACAC;UACAC;QACA;QACAN;MACA;IACA;IAEA;IACAY;MACAR;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC5LA;AAAA;AAAA;AAAA;AAAmrC,CAAgB,mmCAAG,EAAC,C;;;;;;;;;;;ACAvsC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/followup/followup.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/followup/followup.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./followup.vue?vue&type=template&id=603ab7f4&\"\nvar renderjs\nimport script from \"./followup.vue?vue&type=script&lang=js&\"\nexport * from \"./followup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./followup.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/followup/followup.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./followup.vue?vue&type=template&id=603ab7f4&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.getStatusText(_vm.customerInfo.status)\n  var g0 = _vm.followupList.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./followup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./followup.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"followup-container\">\n    <view class=\"customer-info-card\">\n      <view class=\"customer-name\">{{customerInfo.name}}</view>\n      <view class=\"customer-phone\">{{customerInfo.phone}}</view>\n      <view class=\"customer-status\" :class=\"'statusClass-' + customerInfo.status\">\n        <text>{{getStatusText(customerInfo.status)}}</text>\n      </view>\n    </view>\n    \n    <!-- 跟进记录列表 -->\n    <view class=\"followup-list\">\n      <view class=\"followup-list-title\">\n        <uni-icons type=\"chatbubble\" size=\"18\"></uni-icons>\n        <text>跟进记录</text>\n      </view>\n      <view class=\"timeline\" v-if=\"followupList.length > 0\">\n        <view class=\"timeline-item\" v-for=\"(item, index) in followupList\" :key=\"index\">\n          <view class=\"timeline-item-dot\"></view>\n          <view class=\"timeline-item-content\">\n            {{ item.info }}\n            <view class=\"timeline-item-header\">\n              <view class=\"timeline-item-time\">{{item.ctime}}</view>\n            </view>\n          </view>\n        </view>\n      </view>\n      <view class=\"empty-records\" v-else>\n        <text>暂无跟进记录</text>\n      </view>\n    </view>\n    \n    <!-- 添加跟进记录表单 -->\n    <view class=\"add-followup-form\">\n      <view class=\"form-title\">添加跟进记录</view>\n      <view class=\"form-item\">\n        <view class=\"form-item-content\">\n          <textarea v-model=\"formData.content\" placeholder=\"请输入跟进内容\" />\n        </view> \n      </view>\n      <view class=\"form-buttons\">\n        <button class=\"btn btn-cancel\" @click=\"goBack\">取消</button>\n        <button class=\"btn btn-submit\" @click=\"submitFollowup\">确定</button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport customerApi from '@/api/customer.js';\n\nexport default {\n  data() {\n    return {\n      customerId: null,\n      customerInfo: {\n        name: '',\n        phone: '',\n        status: ''\n      },\n      followupList: [],\n      formData: {\n        content: ''\n      },\n      loading: false\n    }\n  },\n  onLoad(options) {\n    if (options && options.id) {\n      this.customerId = options.id;\n      \n      // 尝试解析传入的客户数据\n      if (options.customerData) {\n        try {\n          const customerData = JSON.parse(decodeURIComponent(options.customerData));\n          this.customerInfo = customerData;\n          console.log('使用传入的客户数据:', this.customerInfo);\n        } catch (error) {\n          console.error('解析客户数据失败:', error);\n        }\n      }\n      \n      // 获取跟进记录\n      this.loadFollowupList();\n    }\n  },\n  methods: {\n    // 获取跟进记录列表\n    loadFollowupList() {\n      if (!this.customerId) return;\n      \n      this.loading = true;\n      \n      // 调用API获取跟进记录\n      customerApi.getCustomerRecords(this.customerId).then(res => {\n        this.loading = false;\n        if (res.success && res.retCode === 200) {\n          // 数据可能是空数组，这是正常情况\n          this.followupList = Array.isArray(res.data) ? res.data : [];\n          \n          if (this.followupList.length === 0) {\n            console.log('暂无跟进记录');\n          }\n        } else {\n          uni.showToast({\n            title: res.message || '获取跟进记录失败',\n            icon: 'none'\n          });\n        }\n      }).catch(err => {\n        this.loading = false;\n        uni.showToast({\n          title: '获取跟进记录失败',\n          icon: 'none'\n        });\n        console.error('获取跟进记录失败', err);\n      });\n    },\n    \n    // 获取状态文本\n    getStatusText(status) {\n      const statusMap = {\n        '1': '新客户',\n        '2': '意向客户',\n        '3': '已签约',\n        '4': '已流失',\n        '5': '公海客户'\n      };\n      return statusMap[status] || status;\n    },\n    \n    // 日期选择变更\n    onDateChange(e) {\n      this.formData.nextTime = e.detail.value;\n    },\n    \n    // 提交跟进记录\n    submitFollowup() {\n      if (!this.formData.content) {\n        uni.showToast({\n          title: '请输入跟进内容',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      // 防止重复提交\n      if (this.loading) return;\n      this.loading = true;\n      \n      // 调用API提交跟进记录\n      customerApi.addCustomerRecord({\n        id: this.customerId,\n        info: this.formData.content\n      }).then(res => {\n        this.loading = false;\n        if (res.success && res.retCode === 200) {\n          uni.showToast({\n            title: '添加成功',\n            icon: 'success'\n          });\n          \n          // 清空表单\n          this.formData.content = '';\n          \n          // 重新加载跟进记录\n          this.loadFollowupList();\n        } else {\n          uni.showToast({\n            title: res.message || '添加失败',\n            icon: 'none'\n          });\n        }\n      }).catch(err => {\n        this.loading = false;\n        uni.showToast({\n          title: '添加失败',\n          icon: 'none'\n        });\n        console.error('添加跟进记录失败', err);\n      });\n    },\n    \n    // 返回上一页\n    goBack() {\n      uni.navigateBack();\n    }\n  }\n}\n</script>\n\n<style>\n.followup-container {\n  padding: 20rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.customer-info-card {\n  background-color: #fff;\n  border-radius: 10rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n  position: relative;\n}\n\n.customer-name {\n  font-size: 32rpx;\n  font-weight: bold;\n  margin-bottom: 10rpx;\n}\n\n.customer-phone {\n  font-size: 28rpx;\n  color: #666;\n  margin-bottom: 10rpx;\n}\n\n.customer-status {\n  display: inline-block;\n  padding: 4rpx 16rpx;\n  border-radius: 20rpx;\n  font-size: 24rpx;\n  position: absolute;\n  right: 20rpx;\n  top: 20rpx;\n}\n\n.statusClass-1 {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n.statusClass-2 {\n  background-color: #fff7e6;\n  color: #fa8c16;\n}\n\n.statusClass-3 {\n  background-color: #f6ffed;\n  color: #52c41a;\n}\n\n.statusClass-4 {\n  background-color: #fff1f0;\n  color: #f5222d;\n}\n\n.statusClass-5 {\n  background-color: #f5f5f5;\n  color: #8c8c8c;\n}\n\n.followup-list {\n  background-color: #fff;\n  border-radius: 10rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.followup-list-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n  display: flex;\n  align-items: center;\n}\n\n.followup-list-title text {\n  margin-left: 10rpx;\n}\n\n.timeline {\n  padding: 10rpx 0;\n}\n\n.timeline-item {\n  position: relative;\n  padding-left: 40rpx;\n  padding-bottom: 30rpx;\n  border-left: 2rpx solid #e8e8e8;\n}\n\n.timeline-item:last-child {\n  border-left: 2rpx solid transparent;\n}\n\n.timeline-item-dot {\n  position: absolute;\n  left: -10rpx;\n  top: 0;\n  width: 16rpx;\n  height: 16rpx;\n  background-color: #409EFF;\n  border-radius: 50%;\n}\n\n.timeline-item-content {\n  background-color: #f9f9f9;\n  border-radius: 8rpx;\n  padding: 16rpx;\n  line-height: 1.5;\n  font-size: 28rpx;\n}\n\n.timeline-item-header {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 10rpx;\n}\n\n.timeline-item-time {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.timeline-item-user {\n  font-size: 24rpx;\n  color: #666;\n}\n\n.timeline-item-body {\n  font-size: 28rpx;\n}\n\n.timeline-item-content-text {\n  margin-bottom: 10rpx;\n  line-height: 1.5;\n}\n\n.timeline-item-next-time {\n  font-size: 24rpx;\n  color: #1890ff;\n}\n\n.add-followup-form {\n  background-color: #fff;\n  border-radius: 10rpx;\n  padding: 20rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.form-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n}\n\n.form-item {\n  margin-bottom: 20rpx;\n}\n\n.form-item-label {\n  font-size: 28rpx;\n  margin-bottom: 10rpx;\n}\n\n.form-item-content textarea {\n  width: 100%;\n  height: 200rpx;\n  background-color: #f9f9f9;\n  border-radius: 6rpx;\n  padding: 16rpx;\n  font-size: 28rpx;\n}\n\n.picker-text {\n  height: 80rpx;\n  line-height: 80rpx;\n  background-color: #f9f9f9;\n  border-radius: 6rpx;\n  padding: 0 16rpx;\n  font-size: 28rpx;\n}\n\n.form-buttons {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 20rpx;\n}\n\n.btn {\n  font-size: 28rpx;\n  border-radius: 6rpx;\n  margin-left: 20rpx;\n  padding: 0 30rpx;\n  height: 70rpx;\n  line-height: 70rpx;\n}\n\n.btn-cancel {\n  background-color: #f5f5f5;\n  color: #666;\n}\n\n.btn-submit {\n  background-color: #409EFF;\n  color: #fff;\n}\n\n.empty-records {\n  padding: 40rpx 0;\n  text-align: center;\n  color: #909399;\n  font-size: 28rpx;\n  background-color: #f9f9f9;\n  border-radius: 8rpx;\n}\n</style> ","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./followup.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./followup.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1747108657748\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}